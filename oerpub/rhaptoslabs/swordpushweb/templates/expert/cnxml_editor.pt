<metal:use use-macro="base">

<tal:body metal:fill-slot="content">
  ${form.begin(request.route_url('cnxml'), onsubmit="var temp=document.getElementById('form.submitted'); temp.disabled='disabled';")}
  ${form.csrf_token()}
  <div id="header-wrap">
    <div id="header-container">
      <div id="header">
	<img class="cnxlogo" src="${request.static_url('oerpub.rhaptoslabs.swordpushweb:static/images/connexions_icon.png')}"/>
	<h1>Connexions Importer</h1>
	<p class="status">You are logged in as ${request.session['username']}
	  <br/><a href="${request.route_url('logout')}">Click here to sign out</a></p>
	<a href="http://www.shuttleworthfoundation.org/" target="_blank"><img class="sflogo" src="${request.static_url('oerpub.rhaptoslabs.swordpushweb:static/images/sf150.png')}"/></a>
      </div>
    </div>
    <div id="header2-container">
      <div id="header2">
        Be careful not to break the XML!
	<span style="display:none">${form.submit('form.submitted', 'Preview', class_='submit')}</span>
        <div class="headeraction"><a href="#" onclick="document.getElementById('form.submitted').click();">Update preview</a></div>
      </div>
    </div>
  </div>
  <div id="ie6-container-wrap">
    <div id="container" style="padding-top: 120px;">
      <div id="content">
        <textarea id="cnxml" name="cnxml">${cnxml}</textarea>
      </div>
    </div>
  </div>
  ${form.end()}
  <script>
    var editor = CodeMirror.fromTextArea(document.getElementById("cnxml"), {mode: {name: "xmlpure"}, lineWrapping: true});
  </script>
</tal:body>

</metal:use>
